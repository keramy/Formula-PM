"use strict";(self.webpackChunkformula_project_app=self.webpackChunkformula_project_app||[]).push([[269],{52269:(e,t,s)=>{s.r(t),s.d(t,{default:()=>U});var l=s(89379),r=s(65043),a=s(53969),n=s(56803),i=s(24343),o=s(47471),d=s(33539),c=s(41859),u=s(53541),p=s(24793),x=s(5984),m=s(94799),h=s(55895),j=s(26020),g=s(95315),A=s(57401),f=s(79801),b=s(66185),v=s(52912),y=s(42579),D=s(38517),C=s(81911),k=s(78776),T=s(85877),I=s(20312),w=s(74917),S=s(47951),B=s(95512),F=s(51697),z=s(82058),M=s(3665),P=s(37305),W=s(5362),q=s(70579);const L={image:{icon:(0,q.jsx)(I.A,{}),color:"#4caf50",types:["jpg","jpeg","png","gif","bmp","webp"]},pdf:{icon:(0,q.jsx)(w.A,{}),color:"#f44336",types:["pdf"]},document:{icon:(0,q.jsx)(S.A,{}),color:"#2196f3",types:["doc","docx","txt","rtf"]},default:{icon:(0,q.jsx)(B.A,{}),color:"#9e9e9e",types:[]}};const O=function(e){let{taskId:t,projectId:s,files:i=[],onFilesChange:o,maxFiles:d=10,maxSize:u=10}=e;const[p,x]=(0,r.useState)(!1),[I,w]=(0,r.useState)(!1),[S,B]=(0,r.useState)(null),[O,E]=(0,r.useState)(""),U=(0,r.useRef)(null),R=e=>{const t=e.split(".").pop().toLowerCase();for(const[s,r]of Object.entries(L))if(r.types.includes(t))return(0,l.A)((0,l.A)({},r),{},{extension:t});return(0,l.A)((0,l.A)({},L.default),{},{extension:t})},_=e=>{if(0===e)return"0 Bytes";const t=Math.floor(Math.log(e)/Math.log(1024));return parseFloat((e/Math.pow(1024,t)).toFixed(2))+" "+["Bytes","KB","MB","GB"][t]},H=e=>e.size>1024*u*1024?"File size must be less than ".concat(u,"MB"):i.length>=d?"Maximum ".concat(d," files allowed"):i.some((t=>t.name===e.name))?"File with this name already exists":null,N=e=>{const l=Array.from(e),r=[];let a="";for(const t of l){const e=H(t);if(e){a=e;break}r.push(t)}if(a)return E(a),void setTimeout((()=>E("")),5e3);w(!0),setTimeout((()=>{const e=r.map((e=>({id:Date.now()+Math.random(),name:e.name,size:e.size,type:e.type,uploadDate:(new Date).toISOString(),taskId:t,projectId:s,url:URL.createObjectURL(e),file:e})));o([...i,...e]),w(!1),E("")}),1500)},G=e=>{const t=document.createElement("a");t.href=e.url,t.download=e.name,document.body.appendChild(t),t.click(),document.body.removeChild(t)};return(0,q.jsxs)(a.A,{children:[O&&(0,q.jsx)(n.A,{severity:"error",sx:{mb:2},children:O}),(0,q.jsxs)(m.A,{sx:{p:3,mb:3,border:"2px dashed ".concat(p?"#37444B":"#C0B19E"),backgroundColor:p?"#F1EEEA":"transparent",cursor:"pointer",transition:"all 0.3s ease",textAlign:"center"},onDrop:e=>{e.preventDefault(),x(!1);const t=e.dataTransfer.files;t.length>0&&N(t)},onDragOver:e=>{e.preventDefault(),x(!0)},onDragLeave:e=>{e.preventDefault(),x(!1)},onClick:()=>{var e;return null===(e=U.current)||void 0===e?void 0:e.click()},children:[(0,q.jsx)(F.A,{sx:{fontSize:48,color:"#C0B19E",mb:2}}),(0,q.jsx)(h.A,{variant:"h6",gutterBottom:!0,children:"Drop files here or click to browse"}),(0,q.jsx)(h.A,{variant:"body2",color:"text.secondary",gutterBottom:!0,children:"Supports: Images, PDFs, Documents"}),(0,q.jsxs)(h.A,{variant:"caption",color:"text.secondary",children:["Max ",d," files, ",u,"MB each"]}),(0,q.jsx)("input",{ref:U,type:"file",multiple:!0,style:{display:"none"},onChange:e=>{e.target.files.length>0&&N(e.target.files)},accept:"image/*,.pdf,.doc,.docx,.txt"})]}),I&&(0,q.jsxs)(a.A,{sx:{mb:3},children:[(0,q.jsx)(h.A,{variant:"body2",gutterBottom:!0,children:"Uploading files..."}),(0,q.jsx)(j.A,{})]}),i.length>0&&(0,q.jsxs)(m.A,{sx:{p:2},children:[(0,q.jsxs)(h.A,{variant:"h6",gutterBottom:!0,sx:{display:"flex",alignItems:"center",gap:1},children:[(0,q.jsx)(z.A,{}),"Attached Files (",i.length,")"]}),(0,q.jsx)(g.A,{children:i.map((e=>{const t=R(e.name);return(0,q.jsxs)(A.Ay,{sx:{border:1,borderColor:"divider",borderRadius:2,mb:1,backgroundColor:"background.paper"},children:[(0,q.jsx)(f.A,{children:(0,q.jsx)(a.A,{sx:{color:t.color},children:t.icon})}),(0,q.jsx)(b.A,{primary:e.name,secondary:(0,q.jsxs)(a.A,{children:[(0,q.jsxs)(h.A,{variant:"caption",color:"text.secondary",children:[_(e.size)," \u2022 ",t.extension.toUpperCase()]}),(0,q.jsx)("br",{}),(0,q.jsxs)(h.A,{variant:"caption",color:"text.secondary",children:["Uploaded: ",new Date(e.uploadDate).toLocaleDateString()]})]})}),(0,q.jsx)(v.A,{children:(0,q.jsxs)(a.A,{sx:{display:"flex",gap:1},children:[(0,q.jsx)(y.A,{size:"small",onClick:()=>(e=>{const t=R(e.name);"pdf"===t.extension||t.types.includes("image")?B(e):G(e)})(e),title:"Preview/Download",children:(0,q.jsx)(M.A,{})}),(0,q.jsx)(y.A,{size:"small",onClick:()=>G(e),title:"Download",children:(0,q.jsx)(P.A,{})}),(0,q.jsx)(y.A,{size:"small",color:"error",onClick:()=>(e=>{const t=i.filter((t=>t.id!==e));o(t)})(e.id),title:"Delete",children:(0,q.jsx)(W.A,{})})]})})]},e.id)}))})]}),(0,q.jsxs)(D.A,{open:!!S,onClose:()=>B(null),maxWidth:"md",fullWidth:!0,children:[(0,q.jsxs)(C.A,{children:["File Preview: ",null===S||void 0===S?void 0:S.name]}),(0,q.jsx)(k.A,{children:S&&(0,q.jsx)(a.A,{sx:{textAlign:"center",p:2},children:R(S.name).types.includes("image")?(0,q.jsx)("img",{src:S.url,alt:S.name,style:{maxWidth:"100%",maxHeight:"500px",objectFit:"contain"}}):"pdf"===R(S.name).extension?(0,q.jsx)("iframe",{src:S.url,width:"100%",height:"500px",title:S.name}):(0,q.jsx)(h.A,{children:"Preview not available for this file type"})})}),(0,q.jsxs)(T.A,{children:[(0,q.jsx)(c.A,{onClick:()=>B(null),children:"Close"}),(0,q.jsx)(c.A,{variant:"contained",onClick:()=>G(S),startIcon:(0,q.jsx)(P.A,{}),children:"Download"})]})]})]})},E=[{value:"low",label:"Low",color:"#27ae60"},{value:"medium",label:"Medium",color:"#f39c12"},{value:"high",label:"High",color:"#e67e22"},{value:"urgent",label:"Urgent",color:"#e74c3c"}];const U=function(e){let{projects:t,teamMembers:s=[],onSubmit:m,initialTask:h=null}=e;const[j,g]=(0,r.useState)(h?{projectId:h.projectId||"",name:h.name||"",assignedTo:h.assignedTo||"",priority:h.priority||"medium",dueDate:h.dueDate?new Date(h.dueDate):null,description:h.description||""}:{projectId:"",name:"",assignedTo:"",priority:"medium",dueDate:null,description:""}),[A,f]=(0,r.useState)([]),[b,v]=(0,r.useState)({}),[y,D]=(0,r.useState)(!1),C=e=>t=>{g((0,l.A)((0,l.A)({},j),{},{[e]:t.target.value})),b[e]&&v((0,l.A)((0,l.A)({},b),{},{[e]:""}))};return(0,q.jsx)(p.$,{dateAdapter:x.h,children:(0,q.jsxs)(a.A,{component:"form",onSubmit:e=>{if(e.preventDefault(),(()=>{const e={};return j.projectId||(e.projectId="Please select a project"),j.name&&j.name.trim()||(e.name="Task name is required"),j.assignedTo||(e.assignedTo="Please select a team member"),j.dueDate||(e.dueDate="Due date is required"),v(e),0===Object.keys(e).length})()){const e=(0,l.A)((0,l.A)({},j),{},{projectId:parseInt(j.projectId),assignedTo:parseInt(j.assignedTo),dueDate:j.dueDate.toISOString().split("T")[0],files:A});h&&(e.id=h.id),m(e),h||(g({projectId:"",name:"",assignedTo:"",priority:"medium",dueDate:null,description:""}),f([])),D(!0),setTimeout((()=>D(!1)),3e3)}},sx:{display:"flex",flexDirection:"column",gap:2},children:[y&&(0,q.jsx)(n.A,{severity:"success",children:"Task added successfully!"}),(0,q.jsx)(i.A,{select:!0,label:"Select Project",value:j.projectId,onChange:C("projectId"),error:!!b.projectId,helperText:b.projectId||(0===t.length?"Create a project first":""),fullWidth:!0,required:!0,disabled:0===t.length,children:t.map((e=>(0,q.jsxs)(o.A,{value:e.id,children:[e.name," (",e.type,")"]},e.id)))}),(0,q.jsx)(i.A,{label:"Task Name",value:j.name,onChange:C("name"),error:!!b.name,helperText:b.name,fullWidth:!0,required:!0}),(0,q.jsx)(i.A,{select:!0,label:"Assigned To",value:j.assignedTo||"",onChange:C("assignedTo"),error:!!b.assignedTo,helperText:b.assignedTo||(0===s.length?"Add team members first":""),fullWidth:!0,required:!0,disabled:0===s.length,children:s.filter((e=>"active"===e.status)).map((e=>(0,q.jsx)(o.A,{value:e.id,children:(0,q.jsxs)(a.A,{sx:{display:"flex",alignItems:"center",gap:1},children:[(0,q.jsx)(d.A,{sx:{width:24,height:24,fontSize:12,bgcolor:e.roleColor},children:e.initials}),e.fullName," - ",e.role]})},e.id)))}),(0,q.jsx)(i.A,{select:!0,label:"Priority",value:j.priority,onChange:C("priority"),fullWidth:!0,required:!0,children:E.map((e=>(0,q.jsx)(o.A,{value:e.value,sx:{borderLeft:"4px solid ".concat(e.color),marginBottom:.5},children:e.label},e.value)))}),(0,q.jsx)(u.l,{label:"Due Date",value:j.dueDate,onChange:e=>{g((0,l.A)((0,l.A)({},j),{},{dueDate:e})),b.dueDate&&v((0,l.A)((0,l.A)({},b),{},{dueDate:""}))},minDate:new Date,slotProps:{textField:{error:!!b.dueDate,helperText:b.dueDate,fullWidth:!0,required:!0}}}),(0,q.jsx)(i.A,{label:"Task Description",value:j.description,onChange:C("description"),multiline:!0,rows:2,fullWidth:!0,placeholder:"Optional task details..."}),(0,q.jsx)(O,{taskId:Date.now(),projectId:j.projectId,files:A,onFilesChange:f,maxFiles:5,maxSize:10}),(0,q.jsx)(c.A,{type:"submit",variant:"contained",color:"secondary",size:"large",sx:{mt:2},disabled:0===t.length,children:h?"Save Changes":"Add Task"})]})})}}}]);
//# sourceMappingURL=269.1d20c318.chunk.js.map